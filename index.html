<!-- Whack A Mole! -->
 <!-- used https://png2svg.com/ -->
 <!DOCTYPE html>
 <html lang="en">
 <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whack A Mole!</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Amatic+SC:400,700" type="text/css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/simpleyoungguy/WhackAMole/main/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="https://raw.githubusercontent.com/simpleyoungguy/WhackAMole/main/favicon/favicon.svg" />
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/simpleyoungguy/WhackAMole/main/favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/simpleyoungguy/WhackAMole/main/favicon/apple-touch-icon.png" />
    <link rel="manifest" href="https://raw.githubusercontent.com/simpleyoungguy/WhackAMole/main/favicon/site.webmanifest" />
    <meta property="og:title" content="Whack A Mole!">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en_US">
    <meta property="og:url" content="https://simpleyoungguy.github.io/WhackAMole/">
    <meta property="og:description" content="Quick 10 seconds of fun on your browser! Tap as many trolls as you can!">
    <meta property="og:image" content="https://raw.githubusercontent.com/simpleyoungguy/WhackAMole/main/ogtroll.png">
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="627" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kenia&family=Carter+One&family=Outfit:wght@100..900&display=swap" rel="stylesheet">
 </head>
 <body>
    <div class="wrapper">
        <h1>WHACK-A-MOLE!</h1>
        <span class="score">0</span>
        <h2 class="desc">Hit as many trolls as you can in 10s!</h2>
        <h2 class="timesUp"></h2>

        <div class="game">
            <div class="hole hole1">
                <div class="mole"></div>
            </div>
            <div class="hole hole2">
                <div class="mole"></div>
            </div>
            <div class="hole hole3">
                <div class="mole"></div>
            </div>
            <div class="hole hole4">
                <div class="mole"></div>
            </div>
            <div class="hole hole5">
                <div class="mole"></div>
            </div>
            <div class="hole hole6">
                <div class="mole"></div>
            </div>
        </div>
        <button onclick="startGame()">&#9654 PLAY</button>
    </div>
     

    <script>
        const holes = document.querySelectorAll('.hole');
        const scoreBoard = document.querySelector('.score');
        const moles = document.querySelectorAll('.mole');
        const timesUp = document.querySelector('.timesUp');
        //how to not make same hole pop up again
        let lastHole;
        //how to stop function from running indefinitely?
        let timeUp = false;
        let score = 0;

        // bgm: Unused Shop Loop by Steven O'Brien | https://www.steven-obrien.net/
        // Music promoted by https://www.chosic.com/free-music/all/
        // Creative Commons CC BY-ND 4.0
        // https://creativecommons.org/licenses/by-nd/4.0/
        const bgm = new Audio('bgm.mp3');

        //how much time inbetween moles?
        function randomTime(min, max) {
            return Math.round(Math.random() * (max - min) + min);
        }

        //which hole to pop up from? get random dom element
        function randomHole(holes) {
            const idx = Math.floor(Math.random() * holes.length);
            const hole = holes[idx];
            //
            if(hole === lastHole) {
                console.log('Ah nah that is the same one bud');
                return randomHole(holes);
            }

            lastHole = hole;
            return hole;
        }

        //how to get trolls to pop up?
        function peep() {
            const time = randomTime(200, 1000); //(50, 300) for expert mode
            const hole = randomHole(holes);
            hole.classList.add('up');
            setTimeout(() => {
                hole.classList.remove('up');
                hole.querySelector('.mole').classList.remove('whacked'); //reset
                if(!timeUp) peep(); //adding peep() will make it run indefinitely
            }, time)
        }

        function startGame() {
            timesUp.textContent = ``;
            scoreBoard.textContent = 0;
            timeUp = false;
            score = 0;
            bgm.currentTime = 4.3;
            bgm.play();
            peep();
            setTimeout(() => {
                timesUp.textContent = `Times Up!`;
                timeUp = true;
                bgm.pause();
            }, 10000);
        }

        function bonk(e) {
            //what is isTrusted? for verifying if click is done legititmately
            if (!e.isTrusted) return; //someone faking click on JavaScript
            
            //Ignore click if mole already whacked
            if (this.classList.contains('whacked')) return;

            score++;
            this.classList.add('whacked'); //mark mole as whacked
            this.classList.remove('up');
            scoreBoard.textContent = score;
            // console.log(e);
        }

        moles.forEach(mole => mole.addEventListener('click', bonk));
    </script>
 </body>
 </html>
